time = .3;
Ts = 1/10000;
t = Ts:Ts:time;
lent = length(t);
fc = 1000;
c = cos(2*pi*fc*4 );
fm = 20;
w = 5/lent * (1:lent) + cos(2*pi*fm*t);
v = c.*w;
gamma = 0;
phi = 0;
c2 = cos(2*pi*(fc + gamma)*t + phi);
x= v.*c2;
fbe = [0 0.1 0.2 1];
damps = [1 1 0 0];
fl = 100;
b = remez(fl, fbe, damps);
m = 2 * filter(b, 1, x);
subplot(4, 1, 1);
plot(c);
subplot(4, 1, 2);
plot(v);
subplot(4, 1, 3);
plot(x);
subplot(4, 1, 4);
plot(m);